# 摘要
零知识证明作为隐私保护技术的重要手段,随着区块链技术的发展,逐渐应用于车联网、比特币等各个领域。个人综合信用评分作为促进社会治理的一项措施，与个人隐私息息相关。虽然目前有各种应用场景的信用评分计算系统，但这些系统几乎无视用户隐私保护，导致用户信息泄露或滥用。零知识证明与个人信用评分计算相结合，现阶段已有多名研究人员进行了研究。但是，现有方案中所有数据都是用户直接提供的，没有考虑用户提供虚假数据情况下的数据真实性。在本文中，我们利用零知识证明设计了一种新颖的个人信用评分计算隐私保护方案，同时考虑了多维用户数据的真实性验证。此外，我们的方案还提出了基于区块链的个人信用评分通用验证平台的概念。对于任何需要查询和验证用户信用评分的合格机构，该平台具有更实质的适用性和多功能性。在论文的最后，我们对整体方案进行了安全分析和性能评估。  
索引词——区块链、隐私计算、隐私保护、零知识证明、信用评分计算  
# 一、引言
隐私计算[1]是指在保证数据提供者无需泄露敏感数据的前提下，可以对数据进行分析、计算和验证的信息技术。 在人工智能、金融科技、医疗保障等数据共享场景中发挥着至关重要的作用。 零知识证明[2]作为隐私计算的基本手段，允许一个人在不泄露证明的具体信息的情况下向他人证明一个命题的正确性。  
&emsp;&emsp;零知识证明在金融、医疗、车联网等领域具有很好的应用前景，因为它具有可以有效验证且不泄露有用知识的优良特性。使用零知识证明，Zcash [3] 实现了完全匿名的区块链交易，可以隐藏交易双方的地址和交易信息。相对于比特币在区块链上存储完整的交易细节，Zcash 的链上交易是通过零知识证明应用的，不受其交易链分析的风险。因此，Zcash 对用户来说具有更高的安全性。在移动医疗设备方面，Antonio 等人。为移动设备和智能手机设计了一种零知识身份认证方案[4]，以解决医疗设备通过蓝牙连接到手机时可能出现的数据盗窃和非法数据注入问题。针对交通网络中的数据完整性和数据隐私问题，李万新等。设计了一种交通管理方案 [5]，将来自联网车辆的数据集成到基于零知识证明的实时交通管理系统中。作者进一步开发了该方案的系统原型。  
&emsp;&emsp;信用体系通常与银行和金融机构联系在一起，在发达国家的社会治理中起着决定性的作用。具体而言，信用评分计算（CSC）是指评分机构使用个人信用数据，如账户数量、账户余额、信用卡使用情况和信用记录等，通过风险模型计算信用评分[ 6]基于与信用数据对应的权重。因此，银行、金融机构和其他实体可以量化个人的信用价值或信用风险，然后使用这些量化数据来促进他们的决策[7]。风险模型的研究已经比较成熟，例如基于逻辑回归的信用评分模型[8]和最小二乘支持向量机集成模型[9]。这些模型以个人数据为输入，涉及客户的大量隐私，而这些方案中很少考虑隐私保护[10]-[12]。许多现有的论文 [13]、[14] 在计算信用评分时使用交易对手计算来保护用户的隐私。但是，由于无法验证信用数据，它们具有明显的局限性。因此，Chao Lin 等人。提出了一种将零知识证明与 CSC 相结合的隐私保护信用评分计算 (PCSC) 方案 [15]。 [15]的论文依赖于用户自己收集他的个人数据，并且他与评分机构和受信任的第三方进行了三次非交互式零知识证明的交互。然后，可以基于来自这些交互的信息来计算和证明用户信用评分。这个过程实现了对用户个人信息的隐私保护，前提是用户是可信的，并且他们不会向机构提供虚假数据。但在实际的信用评分评估中，用户提供的数据存在真实性风险。它应该是直接从多个机构获得的，这些机构在业务过程中积累了用户的数据。此外，[15] 的方案不是通用方案，因为对用户信用评分的评估仅限于评分机构本身。
&emsp;&emsp;针对当前信用评分评估方案存在隐私保护的不足，我们结合零知识证明、区块链和智能合约，提出了一种全新的完整隐私保护信用评分计算方案（CPPCSC）。与[15]的方案相比，CSC的数据来自多个数据机构，我们的方案只需要一个零知识证明。本文的贡献总结如下：  
（1）多维数据共享验证：我们不再假设用户是可信的。 他们的信用数据也不再由他们自己整合。 取而代之的是，数据由用户单位、银行、政府部门等数据机构直接单向加密并存储在区块链上。 另一方面，用户以加密形式发布自己的信用数据，根据自己的多维信用数据计算出的信用分数，以及与信用数据和分数相关的零知识证明。 用户提供的加密信用数据无需解密即可证明与区块链上的信用数据是否一致。 此外，可以通过证明其值实际上是由信用数据计算的来验证信用评分。  
(2)个人信用评分通用验证平台：我们在区块链上编写智能合约来验证用户的信用评分。 任何需要验证信用评分的机构都可能触发这些公共智能合约的调用。 因此，我们的方案具有更强的通用性。  
&emsp;&emsp;本文的其余部分组织如下：在第二节中，我们提供了相关的背景和预备知识。 然后，第三节详细介绍了整个系统的设计和实现过程。 在第四节中，我们介绍了仿真结果以及对该方案的性能和安全性的分析。 最后，我们在第五节结束本文。  
# 二、 背景和预备知识  
## A.区块链和智能合约
&emsp;&emsp;区块链是一种分布式账本技术，由多个节点共同维护，利用密码学保证传输和访问的安全，利用区块链结构存储数据。 它具有许多特性，例如一致的存储、防篡改和不可否认的特性。 区块链结构由从后到前按时间顺序链接在一起的块组成，其中每个块包含一个周期内的一组交易、一个时间戳和一个指向前一个块的哈希值。 此外，区块链技术利用点对点网络来实现平等互信的节点之间的去中心化。 此外，它利用共识机制确保所有节点在去中心化组织中达成共识。 基于区块链的存储结构、数据的多副本和共识机制，区块链具有数据不可篡改的重要特征。  
&emsp;&emsp;作为运行在区块链上的分布式程序，智能合约自动执行一系列预定义的规则。 由于区块链上数据的公开透明，合约处理数据的代码也是公开透明的。 当智能合约部署在区块链上时，任何人都可以查看代码。 得益于区块链的不可篡改特性，智能合约的代码及其生成的输出也是不可篡改的。 因此，运行智能合约的节点不必专注于其他节点对代码和数据的恶意修改。 区块链网络中的数千个节点通过共识机制保持数据的一致性。 少于 50% 的部分节点故障不会导致智能合约终止。 这确保了智能合约的可靠性。  
## B.零知识证明Zero-knowledge proof 
&emsp;&emsp;零知识证明意味着一个人可以向另一个人证明一个陈述的正确性，而无需透露该陈述的有用知识。 零知识证明中存在三个角色：可信第三方（TTP）、证明者和验证者。 他们各自的职责简述如下:    
&emsp;&emsp;可信第三方：TTP为一个问题构造了一个秘密函数f(x)，例如这个问题就是本文中的信用评分计算。 证明者将证明他知道 f(x) 的答案，而不会透露答案本身。 此外，TTP 会在我们的方案中提供一个智能合约，由 Verifier 调用来验证 Prover 的证明是否有效。  
&emsp;&emsp;Prover：Prover 需要注册到 TTP。 他可以在本地生成一个证明，用于他学习 f(x) 的答案，而该证明包含关于答案的零知识。  
&emsp;&emsp;Verifier：验证者调用 TTP 创建的智能合约来验证 Prover 提供的证明。 在验证过程中，验证者可能不会获得任何关于证明者答案的有用知识，因为它是一个零知识证明。    
&emsp;&emsp;综上所述，零知识证明具有以下特点[16]： 1）完整性：验证者可能会收到 Prover 生成的有效证明； 2) 知识：只有拥有 f(x) 的秘密答案的 Prover 才能生成证明，并且只有 Verifier 才能成功验证； 3）零知识：验证者无法从证明中获得任何有用的答案知识。  
## C. zk-SNARK
&emsp;&emsp;零知识简洁知识论证（zk-SNARK）[17]是一种基于算术电路可满足性的零知识证明协议。 在 zk-SNARK 协议中，证明者可以简洁地说服任何验证者相信给定断言的有效性，并且该协议实现了无需证明者和验证者交互的零知识计算。 zk-SNARK 验证时间短，证明量小，特别适用于区块链。 因此，区块链项目 Zcash 发行了加密货币 ZEC，它利用 zk-SNARK 实现了区块链交易的匿名交易模式 [3]。 [18] 的作者针对原始图像更改（即裁剪、旋转或压缩等）后传统签名失效的问题。 他们提出了一种基于 zk-SNARK 的新图像认证方案 [18]，支持图像多次更改后的签名认证。  
&emsp;&emsp;在本文中，我们首次将 zk-SNARK 和 CSC 结合起来，并通过智能合约验证计算的正确性。 zk-SNARK的工作过程和性质解释如下：  
[1.png](1.png)
一个元组((keyGen, Prove, Verify)可以描述zk-SNARK的工作流程，展示在[Fig.1](fig1.png)  
&emsp;&emsp;上面的keyGen、Prove、Verify都是用函数的形式表示的。 开源项目“libsnark”1实现了zk-SNARK协议，包括这三个在实际使用中被选择和调用的函数。
## Personal credit score
个人信用评分是指通过计算个人信用数据进行的量化信用评价。评估结果确定了个人的“金融信托价值”[19]、[20]，广泛应用于个人信用、信用卡、保险理赔等金融业务，为信用政策制定、分析提供量化支持，评估和优化。但是，信用评分计算需要大量的个人数据。以 FICO2 为例，所需的个人资料包括但不限于信用还款记录、
信用账户数量、有效期、信用卡类型、新开信用账户等。
显然，这些数据涉及大量的个人隐私。此外，用于计算信用评分的个人数据是多维的，即来自多个不相关的组织。这些组织可能不支持以保护商业秘密或客户隐私为目的的明文形式的数据共享。目前，一些方案[13]、[14]利用多方协同计算共享密文，从而实现信用评分计算。但是，信用数据的真实性无法验证，因此我们可能无法保证分数的有效性。因此，在不泄露个人隐私的前提下，计算出准确、合理、可验证的信用评分存在诸多挑战。
# OUR PROPOSED CPPCSC SCHEME
&emsp;&emsp;为了保护个人隐私，我们提出了一种基于 zk-SNARK 和区块链的新型信用评分计算方案。 区块链最显着的特点是其数据不可篡改和删除。 这与信用数据不允许被修改和丢失的要求是一致的。 此外，由于区块链的公开透明特性，我们将加密后的信用数据放在区块链上，方便多维数据共享。 依靠zk-SNARK，通过共享数据计算的信用评分变得可验证。因此，zk-SNARK与区块链的结合可以解决当前信用评分计算方案中的上述两大问题。  
&emsp;&emsp;具体来说，我们允许评分机构扮演 TTP 的角色，完成 zk-SNARK 中的“设置”步骤，并在区块链上创建智能合约以进行证明验证。多方数据机构通过不可逆密码算法生成加密数据并实时上传到区块链，当用户与机构进行交易时，例如在银行开立信用账户。之后，当用户有信用评分要求时，他会向多方数据机构发送数据收集请求。这些机构在收到用户对信用数据的请求后，将相应的明文反馈给他。然后，用户在 zk-SNARK 中充当证明者，通过为他的信用评分生成一个证明，该证明是通过使用用户本地设备中收集的信用数据通过风险模型计算的。用户将证明与信用评分一起发送给信用评分验证机构，该机构在 zk-SNARK 中充当验证者。最后，验证机构调用区块链上的智能合约来验证收到的证明和分数的有效性。  
## A. System model
该模型包含一系列不同的角色，包括用户、多方数据机构、区块链、智能合约、评分机构和信用评分验证机构。 角色之间的交互如[图2](fig2.png)所示。
  
- User：作为信用评分的发起者，用户通过其智能手机中的App向多方数据机构发送获取其明文信用数据的请求。 他通过安全传输通道获得返回的数据后，在本地计算信用评分以生成证明。 然后，他将证明连同信用评分一起发送给验证机构。 由于信用数据属于用户自己，在本地环境中只是可视的，所以当证明和公开数据向外传输时，用户侧不存在数据泄露的风险。 为了保证信用评分的及时性，同一用户必须向多方数据机构索取最新的信用数据，才能进行新的信用评分。
- Multi-party data agency：通常，用户用于信用评分的信用数据不仅来自一方，还来自多家银行、工作机构、派出所等机构。 根据数据安全法律法规，未经客户明确同意，机构不得泄露客户数据。 因此，可以合理地假设各局将严格执行这些规定。 结果，明文信息可能只流向用户自己。 在客户的业务交易过程中，如银行的金融业务和保险公司的业务，数据代理机构即银行或保险公司会及时将更新后的信用数据上传到区块链进行后续验证，数据被不可逆加密 在传输之前。 这保证了信用数据的及时性和可信度。
- Credit score verification agency：验证机构是指利用用户的信用评分对其业务需求做出特定决策的机构。 例如，保险公司根据用户的信用评分来评估用户支付的保险费水平。 同样，汽车销售机构使用客户的信用评分来确定他们的汽车贷款金额。 这些机构调用在区块链上运行的智能合约来验证证明和包括信用评分在内的公共数据。 验证成功表明用户提供了真实有效的信用评分。
- Scoring agency:它负责注册用户和验证机构。 它还充当 TTP 的角色：在 zk-SNARK 的设置阶段生成公共参数 pk 和 vk，并为验证机构创建验证智能合约。
- Blockchain and smart contracts：区块链维护来自多个数据机构的用户加密数据。 智能合约可以根据记录在区块链上的数据验证用户提供的证明。 注册的验证机构通过调用智能合约成为验证者。

## B.System implementation
&emsp;&emsp;在本节中，我们将介绍 CPPCSC 的工作流程，如图 2 中的箭头所示。 首先，我们声明了一些函数。 对于随机数种子x，我们定义了一个随机函数k = PFRkx(·)和一个加密函数c = COMMx(m)，其中m代表明文消息，c通常可以通过SHA256或其他单向加密来实现功能。 从 c 的定义中，我们可以发现它是由 x 和 m 决定的。 因此，对于 c 和 c0 = COMMx(m0)，任何人都可以判断 c 和 c0 是否相等，进而推断 m0 是否等于原始秘密值 m。  
1）初始化阶段：我们的系统涉及到多方的合作。 在初始阶段，需要进行以下三个步骤的准备工作：

- Setup:评分机构根据电路可满足性问题[17]设计相应的信用评分计算电路C。此外，评分机构使用算法1（见第III-C节）生成pk和vk，其中pk在用户注册时发放给用户，vk预先嵌入验证合约中。
- Smart contract deployment:评分机构实现验证智能合约并将其部署到区块链节点。
- User registration:用户使用该应用程序生成一个唯一的标识 ID，作为他的私人信息安全地存储在他的设备中。 用户根据这个ID计算出k=PFRkx(ID)，其中k代表他在系统中的匿名身份。

2）作为证据保存在区块链上的加密信用数据：用户的信用数据是在与数据机构的业务交易中产生的。 然后，相应的数据机构将立即将加密后的数据保存在区块链上，以供日后验证。   
具体来说，ag1、ag2、ag3等数据机构在与用户u进行业务往来时，会得到用户u对应的匿名身份ku和他的明文信用数据magi u（i=1；2；3）。 随后，各机构通过 ci u = COMMx(magi u jjku)(i = 1; 2; 3) 计算出 u 的加密信用数据 ci u 并上传至区块链。 作为分布式账本，区块链可以确保存储的 ci 不可篡改和可追溯，同时保持对所有人透明。  
3) 用户请求他的信用数据：用户 u 需要他的信用数据来计算信用评分。 因此，用户u向各个数据代理发送数据请求，等待反馈。 ag1、ag2、ag3的代理机构返回请求的u个人信用数据明文，即mag1 u ;mag2 u 和mag3 u 。 结果，你拥有了他所有的明文信用数据。  
4) 用户在本地生成他的信用评分和证明:在u获得他的mag1 u ;mag2 u和mag3 u的信用数据后
5) 基于区块链智能合约的证明验证:我们在区块链上编写智能合约以成为“验证者”。 依靠区块链的数据透明特性，信用评分验证过程对任何选择监督检查的人来说都是完全可见的。 智能合约中的验证算法在算法3中有详细描述。  
任何验证机构都可以调用运行在区块链上的智能合约来验证用户 u 提供的证明和公开数据。 随后，该机构将其从区块链收到的验证结果通知用户 u。

## C. Algorithm construction
在本节中，我们具体描述了前面在第 III-B 节中提到的三种算法，它们分别以 CPPCSC setup、ProofGeneration 和 ScoreVerify 为代表。 CPPCSC 设置描述了评分机构生成 pk 和 vk 的详细步骤，如[Algorithm 1](Algorithm%201.png)所示。[Algorithm 2](Algorithm%202..png)
[Algorithm 3](Algorithm%203.png)
# 性能和安全分析
据我们所知，本文提出的方案首次结合了 zk-SNARK、区块链和 CSC 来保护信用评分领域的隐私。 为了保证其在实际应用中的可行性，我们首先对方案主要步骤的存储和耗时进行了测试。 进一步分析了其安全隐私保护能力。
## A. Storage and time consumption
该方案的存储和时间消耗主要发生在CPPCSC setup、ProofGeneration和ScoreVerify这三种算法中。 因此，我们在模拟环境中运行它们并收集结果进行分析。 考虑到实践中不同风险模型中使用的信用数据项的数量不同，我们评估了信用数据项的数量对pk、vk和proof的大小和生成时间的影响。 此外，我们检测了区块链上智能合约执行证明验证的时间成本。  
1）初始化和证明生成测试：在我们的模拟中，我们使用 libsnark 的组件 Gadget1 构建了算法 1 中的算术电路 Cscore。 此外，我们依靠另一个 libsnark 的组件，名为 r1cs gg ppzksnark 来实现证明验证系统。 此外，PFRkx 和 COMMx 函数使用 SHA256 算法实现。  
信用数据项数可能增加的场景有两种：数据机构增量的数量和单个机构增量的数据项数量。因此，我们分别测试了它们对我们方案性能的影响。我们在假设数据来自两个数据机构的情况下运行模拟程序，每个机构提供总共 7、14、21 和 28 个信用数据项。测试结果总结在表I中。  
如表一所示，我们可以得出以下结论：  
CPPCSC setup:  
随着信用数据项的数量翻倍、翻倍、翻倍，这个阶段的时间消耗增加，但不会多次变化。具体来说，7项和28项之间的最大时间差保持在3.8s。 pk 的大小保持在 18.2MB 左右，每个数据项的数量没有太大差异。进一步检查表 I 中验证密钥的大小，所有 vk 的大小相同，均为 248621 位（30.35KB），因为它们的生成仅取决于公共数据项的数量，如第 II-C 节所述。这种适中的大小可以嵌入到智能合约中。

............

## B. Security and privacy analysis


